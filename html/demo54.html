<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

</body>
<script>
    // let corp = {}
    // corp.list = {}
    // // 订阅事件
    // corp.on = function (key,fn) {
    //     if (!this.list[key]) {
    //         this.list[key] = []
    //     }
    //     this.list[key].push(fn)
    // }
    // // 发布事件
    // corp.emit = function () {
    //     let key = [].shift.call(arguments),
    //         fns = this.list[key]
    //     if (!fns || fns.length === 0) {
    //         return false
    //     }
    //     fns.forEach(fn => {
    //         fn.apply(this,arguments)
    //     })
    // }
    //
    // corp.on('join',(position,salary) => {
    //     console.log('你的职位是：',position)
    //     console.log('期望薪资：',salary)
    // })
    // corp.on('other', (skill,hobby) => {
    //     console.log('你的技能有：',skill)
    //     console.log('爱好：',hobby)
    // })
    //
    // corp.emit('join','前端',10000)
    // corp.emit('other','端茶倒水','足球')

    let event = {
        list: {},
        on(key,fn) {
            if (!this.list[key]) {
                this.list[key] = []
            }
            this.list[key].push(fn)
        },
        emit() {
            console.log('arguments====',arguments)
            let key = [].shift.call(arguments),
                fns = this.list[key]
            console.log('key====',key)
            console.log('fns====',fns)
            if (!fns || fns.length === 0) {
                return false
            }
            fns.forEach(fn => {
                fn.apply(this,arguments)
            })
        },
        remove(key,fn){
            let fns = this.list[key]
            if (!fn) {
                return false
            }
            if (!fn) {
                fns && (fns.length = 0)
            } else {
                fns.forEach((cb,i) => {
                    if (cb === fn) {
                      fns.splice(i,1)
                    }
                })
            }
        }
    }

    function cat() {
        console.log('一起喵喵喵')
    }
    function dog() {
        console.log('一起旺旺旺')
    }

    event.on('pet',data=> {
        console.log('接收数据');
        console.log(data)
    })
    event.on('pet',cat)
    event.on('pet',dog)

    // event.remove('pet',dog)
    event.emit('pet',['二哈','波斯猫'])
</script>
</html>
